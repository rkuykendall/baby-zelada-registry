{% extends "base.html" %}
{% load math_filters %}

{% block content %}
<h2>Thank you for checking out our registry!</h2>
<p>Please ship items directly to our home. Reach out if you need our address, or have any issues entering a gift you bought.</p>
<p><b>We'd LOVE your hand-me-downs!</b> Rather than buying us something new, we'd be delighted to receive used items in good condition (even if it's not the exact brand/type listed below).</p>

{% for category in categories %}
<h2>{{ category.name }}</h2>
<table>
    <thead>
        <tr>
            <th></th>
            <th>Item</th>
            <th>Price</th>
            <th>Needed</th>
            <th></th>
        </tr>
    </thead>
    {% for item in category.item_set.all %}
    <tr>
        <td width="100px">
            {% if item.photo %}
                <a href="{{ item.photo }}" target="_blank"><img src="{{ item.photo }}"></a>
            {% endif %}
        </td>

        <td width="300px">
            {% if item.link %}
                <a href="{{ item.link }}" target="_blank">{{ item.name }}</a>
            {% else %}
                {{ item.name }}
            {% endif %}
        </td>

        <td width="100px">
            {% if item.price %}
                ${{ item.price }}
            {% endif %}
        </td>

        {% if item.quantity_desired|subtract:item.num_gifts > 0 %}
            <td width="100px">Missing {{ item.quantity_desired|subtract:item.num_gifts }}</td>
            <td width="150px"><a class="button" href="{% url 'create_gift' %}?item_id={{ item.id }}">I bought this</a></td>
        {% else %}
            <td></td>
            <td>Done!</td>
        {% endif %}
    </tr>
    {% endfor %}
</table>
{% endfor %}
{% endblock %}
